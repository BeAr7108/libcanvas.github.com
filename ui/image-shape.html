<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>LibCanvas :: Projective Image</title>
		<link href="/files/styles.css" rel="stylesheet" />
		<script src="/files/js/atom.js"></script>
		<script src="/files/js/libcanvas.js"></script>
	</head>
	<body>
		<canvas></canvas>
		<p><a href="/">Return to index</a></p>
		<script>
LibCanvas.extract();
atom.dom(function () {

	var PolyImage = atom.Class({
		Extends: Drawable,

		Implements: [ Draggable, Clickable ],

		initialize: function (libcanvas) {
			libcanvas.addElement( this );

			this.from = new Point(200, 200);
			this.shape = new LibCanvas.Shapes.Polygon([
				[218, 225],
				[310, 225],
				[301, 318],
				[264, 329],
				[227, 318]
			]).addEvent('move', function (diff) {
				this.from.move( diff );
				this.libcanvas.update();
			}.bind(this));

			this.addEvent( 'statusChanged', libcanvas.update );

			this.draggable().clickable()
		},

		draw: function () {
			this.libcanvas.ctx.drawImage({
				image: this.libcanvas.getImage('test'),
				from : this.from
			});

			if (this.active) {
				this.libcanvas.ctx.fill( this.shape, 'rgba(0,255,0,0.5)' );
			} else if (this.hover) {
				this.libcanvas.ctx.fill( this.shape, 'rgba(0,255,0,0.2)' );
			}
		}
	});

	var libcanvas = new LibCanvas('canvas', {
		preloadImages: { test: '/files/img/html5-logo-small.png' }
	})
	.size(800, 500, true)
	.listenMouse()
	.start()
	.addEvent( 'ready', function () {
		var img = new PolyImage( libcanvas );
		libcanvas.update();
	});
});
		</script>
		<script src="/files/js/google-analytics.js"></script>
	</body>
</html>