<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>LibCanvas :: Ui :: Ellipse</title>
		<link href="/files/styles.css" rel="stylesheet" />
		<script src="/files/js/atom.js"></script>
		<script src="/files/js/libcanvas.js"></script>
	</head>
	<body>
		<canvas></canvas>
		<div id="run">Run</div>
		<p><a href="/">Return to index</a></p>
		<script>
new function () {
	LibCanvas.extract();

	var libcanvas = new LibCanvas('canvas', {
		fps: 20,
		preloadImages: { arrow: '/tests/animation/arrow.png' }
	});

	libcanvas.addEvent( 'ready', function () {
		libcanvas.size( 100, 100, true ).start();

		var animation;

		atom.dom('#run').bind( 'click', function () {
			var a = animation = new LibCanvas.Animation.Sprite()
				.addSprites( libcanvas.getImage('arrow'), 100 )
				.run({ line: Array.range(0, 11), delay: 50, repeat: 1 })
				.addEvent('changed', libcanvas.update )
				.addEvent('stop', function () {
					if (animation == a) {
						animation = null;
					}
				});

		});

		libcanvas.addRender(function () {
			libcanvas.ctx.fillAll('black');

			if (animation)  {
				if (animation.sprite) {
					libcanvas.ctx.drawImage( animation.sprite );
				} else {
					console.log( animation );
					throw new Error('image disapear');
				}
			}
		});
	});
};
		</script>
		<script src="/files/js/google-analytics.js"></script>
	</body>
</html>